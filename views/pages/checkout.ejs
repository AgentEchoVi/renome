<!DOCTYPE html>
<html lang="<%= lang %>">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= t.checkout.pageTitle %> &mdash; Renome</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('../partials/header') %>

  <div class="checkout-page">
    <div class="container">
      <h1 class="checkout-page__title"><%= t.checkout.pageTitle %></h1>

      <div class="checkout-grid">
        <!-- Form column -->
        <div class="checkout-form">
          <form id="checkoutForm">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">

            <!-- Delivery type -->
            <fieldset class="checkout-fieldset">
              <legend class="checkout-legend"><%= t.checkout.orderType %></legend>
              <div class="checkout-toggle">
                <label class="checkout-toggle__option">
                  <input type="radio" name="delivery_type" value="delivery" id="dtDelivery" checked>
                  <span><%= t.checkout.deliveryType %></span>
                </label>
                <label class="checkout-toggle__option">
                  <input type="radio" name="delivery_type" value="pickup" id="dtPickup">
                  <span><%= t.checkout.pickupType %></span>
                </label>
              </div>
            </fieldset>

            <!-- Contact info -->
            <fieldset class="checkout-fieldset">
              <legend class="checkout-legend"><%= t.checkout.contactInfo %></legend>
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label"><%= t.checkout.name %> <span class="form-required">*</span></label>
                  <input type="text" name="name" class="form-input" required value="<%= user ? user.name : '' %>">
                </div>
                <div class="form-group">
                  <label class="form-label"><%= t.checkout.phone %> <span class="form-required">*</span></label>
                  <input type="tel" name="phone" class="form-input" required placeholder="+373 ...">
                </div>
              </div>
              <div class="form-group">
                <label class="form-label"><%= t.checkout.email %></label>
                <input type="email" name="email" class="form-input" value="<%= user ? user.email : '' %>">
              </div>
            </fieldset>

            <!-- Delivery address -->
            <fieldset class="checkout-fieldset" id="addressGroup">
              <legend class="checkout-legend"><%= t.checkout.addressSection %></legend>
              <div class="form-group">
                <label class="form-label"><%= t.checkout.addressPlaceholder %> <span class="form-required">*</span></label>
                <textarea name="address" class="form-textarea" rows="3"></textarea>
              </div>
            </fieldset>

            <!-- Payment method -->
            <fieldset class="checkout-fieldset">
              <legend class="checkout-legend"><%= t.checkout.paymentMethod %></legend>
              <div class="checkout-payment-options">
                <label class="checkout-payment-card">
                  <input type="radio" name="payment_method" value="cash" checked>
                  <div class="checkout-payment-card__inner">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="6" width="20" height="12" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></svg>
                    <span class="checkout-payment-card__label"><%= t.checkout.cash %></span>
                  </div>
                </label>
                <label class="checkout-payment-card">
                  <input type="radio" name="payment_method" value="card">
                  <div class="checkout-payment-card__inner">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                    <span class="checkout-payment-card__label"><%= t.checkout.card %></span>
                  </div>
                </label>
                <label class="checkout-payment-card checkout-payment-card--disabled">
                  <input type="radio" name="payment_method" value="online" disabled>
                  <div class="checkout-payment-card__inner">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                    <span class="checkout-payment-card__label"><%= t.checkout.online %></span>
                    <span class="checkout-payment-card__badge"><%= t.checkout.onlineSoon %></span>
                  </div>
                </label>
              </div>
            </fieldset>

            <!-- Notes -->
            <div class="form-group">
              <label class="form-label"><%= t.checkout.comment %></label>
              <textarea name="comment" class="form-textarea" rows="2" placeholder="<%= t.checkout.commentPlaceholder %>"></textarea>
            </div>

            <button type="submit" class="btn btn--primary btn--full" id="submitOrderBtn">
              <%= t.checkout.placeOrder %>
            </button>
          </form>
        </div>

        <!-- Order summary sidebar -->
        <aside class="checkout-summary">
          <div class="cart-summary">
            <h3 class="cart-summary__title"><%= t.checkout.yourOrder %></h3>
            <div id="checkoutItems"></div>
            <div class="cart-summary__row">
              <span><%= t.cart.delivery %></span>
              <span class="cart-summary__free"><%= t.cart.free %></span>
            </div>
            <div class="cart-summary__divider"></div>
            <div class="cart-summary__total">
              <span><%= t.cart.total %></span>
              <span id="checkoutTotal">0 MDL</span>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </div>

  <%- include('../partials/footer') %>

  <div class="toast" id="toast">
    <span class="toast__text" id="toastText"></span>
  </div>

  <script>window.__t = { addedToCart: '<%= t.toast.addedToCart %>', placingOrder: '<%= t.checkout.placingOrder %>', placeOrder: '<%= t.checkout.placeOrder %>', errorPrefix: '<%= t.errors.prefix %>', unknownError: '<%= t.errors.unknown %>', networkError: '<%= t.errors.network %>' };</script>
  <script src="/js/cart.js"></script>
  <script src="/js/checkout.js"></script>
  <script src="/js/main.js"></script>
</body>
</html>
